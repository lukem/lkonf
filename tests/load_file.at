AT_SETUP([load_file])

AT_CHECK([lkonf_test load_file], [0], [ignore])

AT_CHECK_UNQUOTED([lkonf_test -a ${abs_srcdir}/files/simple.lua load_file], [0], [dnl
lkonf_load_file()
load_file:    ${abs_srcdir}/files/simple.lua
result:       0 (LK_OK)
error_code:   0 (LK_OK)
error_string: @&t@
])

AT_CHECK_UNQUOTED([lkonf_test -a ${abs_srcdir}/files/print.lua load_file], [0], [dnl
lkonf_load_file()
load_file:    ${abs_srcdir}/files/print.lua
result:       5 (LK_CALL_CHUNK)
error_code:   5 (LK_CALL_CHUNK)
error_string: ${abs_srcdir}/files/print.lua:2: attempt to call global 'print' (a nil value)
])

AT_CLEANUP()
